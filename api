import { GoogleGenerativeAI } from "@google/generative-ai";

export default async function handler(req, res) {
  if (req.method !== "POST") {
    return res.status(405).json({ error: "Méthode non autorisée" });
  }

  try {
    const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);
    const model = genAI.getGenerativeModel({ model: "gemini-pro" });

    const result = await model.generateContent(req.body.message);
    res.status(200).json({ reply: result.response.text() });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
}
{
  "functions": {
    "chat.js": {
      "runtime": "nodejs18.x"
    }
  }
}
<div class="p-4">
  <textarea id="userInput" class="border p-2 w-full" placeholder="Pose ta question..."></textarea>
  <button onclick="sendMessage()" class="bg-orange-500 text-white px-4 py-2 mt-2">Envoyer</button>
</div>

<div id="response" class="mt-4 p-4 border"></div>

<script>
async function sendMessage() {
  const message = document.getElementById("userInput").value;
  const res = await fetch("/chat", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message })
  });
  const data = await res.json();
  document.getElementById("response").innerText = data.reply;
}
</script>
